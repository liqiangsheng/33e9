<!DOCTYPE html PUBLIC "" "">
<html>
<head>
	<meta name="renderer" content="ie-stand">
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
	<title>双录demo</title>

	
	<meta http-equiv="X-UA-Compatible" content="IE=edge" ></meta>
	<meta http-equiv="cache-control" content="no-cache">
	<meta name="viewport" content="width=device-width, initial-scale=1"></meta>
	<meta name="description" content="cloudroom live demo"></meta>
	<meta name="author" content="deva"/></meta>
	<meta http-equiv="Access-Control-Allow-Origin" content="*"></meta>
	<link rel="stylesheet" type="text/css" href="css/login.css">
	<link rel="stylesheet" type="text/css" href="css/menu.css">
	<link rel="stylesheet" type="text/css" href="css/detail.css">
	
	<link rel="stylesheet" type="text/css" href="css/common.css">
</head>
<body>
	<div class="full_page" id="full_page">
	</div>
	<!--进度条显示弹层  开始-->
	<div class="full_page_div" id="full_page_div">
		<div class="full_page_header">
			<span class="name_label" style="font-size: 14px;color: #fff;">上传面板</span>
			<span class="name_del1" onclick="cancle_upload(g_record)" style="color: #fff;"><img src="image/closepage.png"/></span>
		</div>
		<div class="full_page_msg">
			<span class="msg_label">文件名称：</span>
			<span class="name_label_detail" id="file_name">----</span>
		</div>
		<div class="full_page_msg">
			<span class="msg_label">上传进度：</span>
			<span class="name_label_detail" id="upload_num_percert">----</span>
		</div>
		<div class="full_page_msg" id="percent_container">
			<div class="percent_box" id="percent_box">
				<span class="percent_item" id="percent_item"></span>
			</div>
		</div>
		<div class="full_page_msg">
			<span class="msg_label">上传状态：</span>
			<span class="name_label_detail"  id="upload_status">准备上传</span>
		</div>
		<div class="full_page_button">
			<button class="full_page_cancle" onclick="cancle_upload(g_record)">取消</button>
			<a class="full_page_submit" style="display: none;" id="catSerRecBtn" target="_blank">查看服务端录像</a>
		</div>
	</div>
	<!--进度条显示弹层  结束-->
	<!--视频录制参数设置弹层  开始-->
	<div class="full_page_div2" id="full_page_div2">
		<div class="full_page_header2">
			<span class="name_label2" style="color: #fff;">设置</span>
			<span class="name_min2" onclick="setCancle()" style="color: #fff;"><img src="image/closepage.png"/></span>
			<span class="name_del2" onclick="setCancle()" style="color: #fff;"><img src="image/minpage.png"/></span>
		</div>
		<div class="full_page_tab">
			<!--<span class="ontab" onclick="changeTab(1)" id="tab1" style="margin-left: 20px;">视频</span>-->
			<span id="tab1" onclick="changeTab(1)" class="ontab">录制设置</span>
			<span id="tab2" onclick="changeTab(2)">视频设置</span>
		</div>
		<div class="full_page_div4" id="full_page_div4">
			<div class="full_page_msg3">
				<span class="msg_label3">分辨率：</span>
				<select id="recordWH">
				  <option value ="1" checked="checked">360P(640*360)</option>
				  <option value ="2">480P(848*480)</option>
				  <option value="3">720P(1280*720)</option>
				  <option value="4">1080P(1920*1080)</option>
				  <option value ="5">480P(640*480)</option>
				</select>
			</div>
			<div class="full_page_msg4">
				<span class="msg_label4">码率(kbps)：</span>
				<input id="bitRate" type="text" name="malv" value="350"/>
			</div>
			<div class="full_page_msg5">
				<span class="msg_label5">录制内容类型：</span>
				<input type="radio" name="recDataType" class="recDataType" value="7" checked="checked"/><label>音频+视频</label>
				<input type="radio" name="recDataType" class="recDataType" value="3"/><label>纯音频</label>
			</div>
			<div class="full_page_msg6">
				<span class="msg_label6">上传限制(KB/s)：</span>
				<input id="fuRate" type="text" name="malv" value="100"/>
			</div>
			<div class="full_page_msg7">
				<span class="msg_label7">帧率(取值6~20)：</span>
				<input id="frameRate" type="text" name="frameRate" value="15"/>
			</div>
			<div class="full_page_msg8">
				<span class="msg_label8">录制上传方式：</span>
				<input type="radio" name="recUpType" class="recUpType" value="0" checked="checked" /><label>手动上传</label>
				<input type="radio" name="recUpType" class="recUpType" value="1"  /><label>边录边传</label>
			</div>
		</div>
		<div class="full_page_msg2" id="full_page_msg2">
			<div id="meet_reset_camera" class="meet_video_reset" style="margin-top: 12px;">
				<label class="meet_label">摄像头</label>
				<select id="video_select"></select>
				<!-- <button id="video_operate_btn">关闭</button> -->
			</div>
			<div id="meet_reset_speaker" class="meet_video_reset">
				<label class="meet_label">扬声器</label>
				<select id="spker_select"></select>
			</div>
			<div id="meet_reset_micraphone" class="meet_video_reset">
				<label class="meet_label">麦克风</label>
				<select id="mic_select"></select>
				<!-- <button id="mic_operate_btn">关闭</button> -->
			</div>
			<div id="meet_reset_video_size" class="meet_video_reset">
				<label class="meet_label">视频尺寸</label>
				<select id="size_select">
					<option value="8" selected="true">640*360</option>
					<option value="10">848*480</option>
					<option value="12">1280*720</option>
					<option value="13">1920*1080</option>
				</select>
			</div>
			<div id="meet_reset_video_zl" class="meet_video_reset">
				<label class="meet_label">视频帧率</label>
				<input id="frame_input" type="text" name="meet_reset_video_zl" value="20" />
			</div>
			<div id="meet_reset_video_yx" class="meet_video_reset">
				<p class="radio_contain">
					<input onclick="choseMeetYx(0)" class="radio_label" type="radio" name="meet_yx" checked="checked" value="0" />
					<span class="fs14_col48_verm_disib">视频质量优先</span>
					<input onclick="choseMeetYx(1)" class="radio_label" type="radio" name="meet_yx" value="1"/>
					<span class="fs14_col48_verm_disib">视频流畅优先</span>
				</p>
			</div>
		</div>
		<div class="full_page_button" style="display: block;">
			<button class="full_page_submit2" onclick="setSubmit()">确定</button>
			<button class="full_page_cancle2" onclick="setCancle()">取消</button>
		</div>
	</div>
	<!--视频录制参数设置弹层  结束-->
	<!--警告弹出层 开始-->
	<div class="warning_palyer" id="warning_palyer" style="display: none;">
		<div class="palyer_page_header">
			<span class="player_name_label" style="font-size: 20px;color: #fff;">提示面板</span>
			<span class="player_name_del" onclick="closePlayer()" style="color: #fff;"><img src="image/closepage.png"/></span>
		</div>
		<div class="player_page_msg" id="full_page_msg_input" style="display: none;">
			<span class="player_label"></span>
			<input type="text" name="" value=""/>
		</div>
		<div class="player_page_msg" id="full_page_msg_img" style="display: none;">
			<span class="player_label">上传进度：</span>
			<img src="image/s_03.png" alt="">
		</div>
		<div class="player_page_msg" id="full_page_msg_time" style="display: none;margin-top:40px;">
			<span class="player_one_word">进入会议失败 <span id="login_time">--</span>秒后重新登录</span>
		</div>
		<div class="player_page_msg" id="full_page_msg_normal" style="display: none;">
			<span class="player_label"></span>
			<span class="player_label_detail"></span>
		</div>
		<div class="player_page_button" style="margin-top:40px;">
			<button class="player_page_cancle" style="display: none;"></button>
			<button class="player_page_submit" style="display: none;"></button>
		</div>
	</div>
	<!--警告弹出层结束-->
	<!--alert 弹出层样式 开始-->
	<div class="alert_palyer" id="alert_palyer" style="display: none;">
		<div class="alert_page_header">
			<span class="alert_name_label" style="font-size: 20px;color: #fff;">提示</span>
			<span class="alert_name_del" onclick="closeAlert()" style="color: #fff;"><img src="image/closepage.png"/></span>
		</div>
		<div class="alert_page_msg" id="alert_page_msg">
			<p class="alert_label_detail"></p>
		</div>
		<div class="alert_page_button">
			<button class="alertr_page_commit" onclick="closeAlert()">确定</button>
		</div>
	</div>
	<!--alert 弹出层样式 结束-->
	<!--列表弹出层   开始-->
	<div class="list_container" id="list_container" style="display: none;">
		<div class="list_page_header">
			<span class="list_name_label">录制文件管理</span>
			<span class="list_name_del" onclick="closelistPage()"><img src="image/closepage.png"/></span>
		</div>
		<div class="table_list">
			<table width="100%" border="0" cellspacing="0" cellpadding="0" id="table_list_container">
				<tr>
					<td width="25%"><div class="tabel_list_head">文件名</div></td>
					<td width="18%"><div class="tabel_list_head">文件大小</div></td>
					<td width="14%"><div class="tabel_list_head">文件时长</div></td>
					<td width="10%"><div class="tabel_list_head">上传状态</div></td>
					<td width="33%">操作</td>
				</tr>
			</table>
		</div>
	</div>
	<!--列表弹出层   结束-->
	<!--主页面开始-->
	<div class="container">
  		<div class="login_box form-inline">
  			<div class="login_logo">
  				<img src="image/login_logo.png">
  			</div>
  			<div class="label_words">
  				<span>服务器</span>
  			</div>
  			<div class="login_name">
	  			<div id="login_server_input" class="login_input">
					<input class="normal" type="text" id="server_name" placeholder="请输入账号"  value="www.cloudroom.com"/>
					<!-- <div id="server_name" class="normal" contenteditable="true" placeholder="请输入账号">www.cloudroom.com</div> -->
					<span id="login_server_img"><img class="remeber_server" src="image/icon_14.png"></span>
					<div class="inputLayer"></div>
				</div>
				<ul class="pull_down_name" id="login_server_pull">
					<li>10.8.8.220</li>
					<li>www.cloudroom.com</li>
				</ul>
			</div>
  			<div class="login_cpyname">
	  			<div id="login_cpyname_input" class="login_cpyname_input">
					<input  class="normal" type="text" id="login_cpyname"  value="demo@cloudroom.com"/>
					<div class="inputLayer1"></div>
				</div>
			</div>
			<div class="login_psd">
	  			<div id="login_psd_input" class="login_psd_input">
					<input class="normal" type="password" id="login_psd"  value="123456"/>
					<div class="inputLayer2"></div>
				</div>
			</div>
  			<div class="login_button">
  				<button onclick="login()">登录</button>
  				<!-- <button onclick="location.replace('http://www.baidu.com/')">登录</button> -->
  			</div>
  		</div>
		<div class="menu_box" style="display:none">
  			<div class="menu_left">
  				<div class="meun_left_logo">
  					<span class="detail_header_logo"><img src="image/login_logo.png"/></span>
					<span class="detail_header_logo">双录</span>
  				</div>
  				<ul class="menu_left_ul">
  					<li class="menu_left_li_item onmenu">
  						<a href="#">基金类</a>
  					</li>
  					<li class="menu_left_li_item">
  						<a href="#">期货类</a>
  					</li>
  					<li class="menu_left_li_item">
  						<a href="#">货币市场类</a>
  					</li>
  					<li class="menu_left_li_item">
  						<a href="#">固定收益类</a>
  					</li>
  					<li class="menu_left_li_item">
  						<a href="#">权益类</a>
  					</li>
  					<li class="menu_left_li_item">
  						<a href="#">另类投资类</a>
  					</li>
  				</ul>
  			</div>
  			<div class="menu_right">
  				<ul id="menu_right_content1" style="padding:20px;">
  					<div class="menu_right_title">
	  					<span>基金类</span>
	  				</div>
	  				<div class="menu_right_detail">
	  					<dl>
	  						<dt style="cursor:pointer">
	  							<img src="image/pics.png" onclick="enterRoom()" />
	  						</dt>
	  						<dd>财富宝货币市场基金 00034</dd>
	  					</dl>
	  					<dl>
	  						<dt style="cursor:pointer">
	  							<img src="image/pics.png" onclick="enterRoom()" />
	  						</dt>
	  						<dd>财富宝货币市场基金 00035</dd>
	  					</dl>
	  					<dl>
	  						<dt style="cursor:pointer">
	  							<img src="image/pics.png" onclick="enterRoom()" />
	  						</dt>
	  						<dd>财富宝货币市场基金 00036</dd>
	  					</dl>
	  					<dl>
	  						<dt style="cursor:pointer">
	  							<img src="image/pics.png" onclick="enterRoom()" />
	  						</dt>
	  						<dd>财富宝货币市场基金 00037</dd>
	  					</dl>
	  					<dl>
	  						<dt style="cursor:pointer">
	  							<img src="image/pics.png" onclick="enterRoom()" />
	  						</dt>
	  						<dd>财富宝货币市场基金 00038</dd>
	  					</dl>
	  					<dl>
	  						<dt style="cursor:pointer">
	  							<img src="image/pics.png" onclick="enterRoom()" />
	  						</dt>
	  						<dd>财富宝货币市场基金 00039</dd>
	  					</dl>
	  					<dl>
	  						<dt style="cursor:pointer">
	  							<img src="image/pics.png" onclick="enterRoom()" />
	  						</dt>
	  						<dd>财富宝货币市场基金 00040</dd>
	  					</dl>
	  					<dl>
	  						<dt style="cursor:pointer">
	  							<img src="image/pics.png" onclick="enterRoom()" />
	  						</dt>
	  						<dd>财富宝货币市场基金 00041</dd>
	  					</dl>
	  					<dl>
	  						<dt style="cursor:pointer">
	  							<img src="image/pics.png" onclick="enterRoom()" />
	  						</dt>
	  						<dd>财富宝货币市场基金 00042</dd>
	  					</dl>
	  					<div style="clear: both;"></div>
	  				</div>
  				</div>
  			</div>
			<div class="detail_box" style="display:none">
				<div class="detail_header">
					<span class="detail_header_logo"><img src="image/login_logo.png"/></span>
					<span class="detail_header_logo">双录</span>
				</div>
				<div class="detail_left">
					<div class="detail_left_product">
						<div class="detail_left_product_title">
							<span>产品信息</span>
						</div>
						<ul class="detail_left_product_detail">
							<li>
								<span class="product_detail_title">产品名称：</span>
								<span class="product_detail_main">财富宝货币市场基金</span>
							</li>
							<li>
								<span class="product_detail_title">产品代码：</span>
								<span class="product_detail_main">000397</span>
							</li>
							<li>
								<span class="product_detail_title">产品类型：</span>
								<span class="product_detail_main">货币市场基金</span>
							</li>
							<li>
								<span class="product_detail_title">产品期限：</span>
								<span class="product_detail_main">160天</span>
							</li>
							<li>
								<span class="product_detail_title">风险级别：</span>
								<span class="product_detail_main">较低</span>
							</li>
							<li>
								<span class="product_detail_title">投资收益币种：</span>
								<span class="product_detail_main">人民币</span>
							</li>
						</ul>
					</div>
					<div class="detail_left_product">
						<div class="detail_left_product_title">
							<span>客户信息</span>
						</div>
						<ul class="detail_left_product_tab">
							<li id="baseinfoTab" class="on_tab1">
								<button onclick="showBaseinfo()">基础信息</button>
							</li>
							<li id="IdentityATab">
								<button onclick="showIdentityA()">ID正面</button>
							</li>
							<li id="IdentityBTab">
								<button  onclick="showIdentityB()">ID反面</button>
							</li>
						</ul>
						<ul id="gereninfo" class="detail_left_product_detail">
							<li>
								<span class="product_detail_title">姓名：</span>
								<span class="product_detail_main">王小明</span>
							</li>
							<li>
								<span class="product_detail_title">性别：</span>
								<span class="product_detail_main">男</span>
							</li>
							<li>
								<span class="product_detail_title">出生：</span>
								<span class="product_detail_main">1989年5月3日</span>
							</li>
							<li>
								<span class="product_detail_title">地址：</span>
								<span class="product_detail_main">广东省深圳市南山区科技北一路长远大厦17楼E</span>
							</li>
							<li>
								<span class="product_detail_title">公民身份证号码</span>
								<span class="product_detail_main">440303198905035361</span>
							</li>
						</ul>
						<div id="sfzzm" style="display:none;padding-left: 20px;">
							<img src="image/2.png" style="height:125px;width:200px;" ></img>
						</div>
						<div id="sfzfm" style="display:none;padding-left: 20px;">
							<img src="image/1.png" style="height:125px;width:200px;"></img>
						</div>
					</div>
				</div>
				<div class="detail_right">
					<div class="detail_right_view">
						<div class="detail_right_video">
							<div id="mediaContainer" style="position:absolute"></div>
							<div id="videoAContainer" style="position:absolute"></div>
							<div id="videoBContainer" style="position:absolute"></div>
						</div>
						<ul id="startRecordCon" class="detail_right_tab">
							<li class="on_tab2">
								<button onclick="openSetVideoPanel()">设置</button>
							</li>
							<li class="on_tab2">
								<button onclick="startRecord()">开始录制</button>
							</li>
							<li>
								<button id="playbackBtn" onclick="playbackRecord(g_record)">回放</button>
							</li>
							<li>
								<button onclick="upload(g_record)">上传</button>
							</li>
							<li class="show_all_video_files" style="width: 110px;">
								<button onclick="showAllList()">录制文件管理</button>
							</li>
							<li class="show_all_video_files">
								<button onclick="changeSingle()">单摄像头</button>
							</li>
							<li class="show_all_video_files">
								<button onclick="changeDouble()">双摄像头</button>
							</li>
						</ul>
						<ul id="stopRecordCon" style="display:none" class="detail_right_tab">
							<li class="on_tab2">
								<button onclick="stopRecord()">停止录制</button>
							</li>
						</ul>
					</div>
					<div class="detail_right_act">
						<span>风险提示：买入T+1日确认份额并产生收益，份额确认次日15:00前可查看收益</span>
					</div>
					<div class="detail_right_voice">
						<div class="detail_right_voice1">
							<div class="detail_right_voice1_title"><span>风险告知与提醒</span></div>
							<ul class="detail_right_voice1_item" id="detail_video_lists"></ul>
						</div>
						<div class="detail_right_voice1">
							<div class="detail_right_voice1_title"><span>话术提示</span></div>
							<ul class="detail_right_voice1_item">
								<li>
									<span class="detail_right_voice1_item_name">
										1、开场白：您好，我是xx证券客户经理或投资顾问xxx
									</span>
								</li>
								<li class="onradio">
									<span class="detail_right_voice1_item_name">
										2、目前有一只现金管理产品-汇添富收益快线货币市场基金已经正式上线
									</span>
								</li>
								<li>
									<span class="detail_right_voice1_item_name">
										3、该基金为国内首只T+0货币基金，既能满足您账户中闲置资金的理财需求
									</span>
								</li>
							</ul>
						</div>
					</div>
				</div>
			</div>

  		</div>
	</div>
	<!--[if IE]>
		<object id="crVideoObj" classid="clsid:07EFD662-A1BB-4d8d-9BEE-F7E43E5FEBF5" width="1" height="1" ></object>
		<object id="crMgrObj" classid="clsid:120AD2B0-68F2-46c6-88D8-52173F501C0F" width="1" height="1" ></object>
		<object id="crMeetObj" classid="clsid:9E9DD983-A9F8-4dff-B694-B1AE1C708B1E" width="1" height="1" ></object>
		<object id="crQueueObj" classid="clsid:9AAD199D-A02F-4513-875D-AA81091E44B9" width="1" height="1" ></object>
		<object id="crHttpObj" classid="clsid:7E44F8C9-7C8D-4004-8F45-D9819D78663C" width="1" height="1" ></object>	
        <object id="crScreenShareObj" classid="clsid:6FF142C5-8A36-49d7-B627-D60B803550FC" width="1" height="1" ></object> 
		<script type="text/javascript" src="../../js/CloudroomVideoSDK_iePatch.js"></script>
	<![endif]-->
	<script type="text/javascript" src="js/jquery-1.12.4.min.js"></script>
	<script type="text/javascript" src="js/md5.js"></script>
	<!-- <script type="text/javascript" src="js/css3-mediaqueries.js"></script> -->
	<script type="text/javascript" src="js/html5.js"></script> 
	<script type="text/javascript" src="js/menu.js"></script>
	<script type="text/javascript" src="js/login.js"></script>
	<script type="text/javascript" src="js/detail.js"></script>
	<script type="text/javascript" src="js/uuid.js"></script>
	<script type="text/javascript" src="../../js/CloudroomVideoSDK.js"></script>
	<script type="text/javascript">
		function showBaseinfo()
		{
			$("#baseinfoTab").attr("class", "on_tab1"); 
			$("#IdentityATab").removeClass(); 
			$("#IdentityBTab").removeClass(); 
			$("#gereninfo").css("display","block")
			$("#sfzzm").css("display","none")
			$("#sfzfm").css("display","none")
		}
	
		function showIdentityA()
		{
			$("#baseinfoTab").removeClass(); 
			$("#IdentityATab").attr("class", "on_tab1"); 
			$("#IdentityBTab").removeClass(); 
			$("#gereninfo").css("display","none")
			$("#sfzzm").css("display","block")
			$("#sfzfm").css("display","none")
		}
		function showIdentityB()
		{
			$("#baseinfoTab").removeClass(); 
			$("#IdentityATab").removeClass(); 
			$("#IdentityBTab").attr("class", "on_tab1");
			$("#gereninfo").css("display","none")
			$("#sfzzm").css("display","none")
			$("#sfzfm").css("display","block")
		}
	
		var g_nickname;//用户昵称
		var g_userID;//用户id
		var g_logining = false; // 判断登录状态登录
		var g_usrID;   // 登录成功后 用户id
		var g_mediaObj;  // 创建的 正在播放的媒体对象
		var g_videoAObj; // 创建的 video1 对象
		var g_videoBObj; // 创建的 vidoe2 对象
		var g_startRecord = false;	// 判断回放状态的全局变量
		var g_layout; // 视频和摄像头A 布局 两个视频播放布局
		var g_playbacking = false;  // 是否回放状态
		var g_uploading = false; // 视频是否正在上传
		var g_record;  // 录制视频的文件名称
		var g_recordWidth = 640;  // 录制视频的宽度初始值
		var g_recordHeight = 360; // 录制视频的高度初始值
		var g_bitRate  = 350000;  // 录制视频码率的初始值
		var g_frameRate = 10;  // 录制视频帧率的初始值
		var g_recDataType = 7; // 录制视频的类型 初始值为音频+视频 纯音频为3
		var g_isUploadOnRecording = 0; // 是否边录边传
		var g_FURate = 100*1024; // 录制视频的上传限制初始值 kb/s
		var video_size_arr=[[0,0,0],[144,80,56],[224,128,72],[288,160,100],[336,192,150],[448,256,200],[512,288,250],[576,320,300],[640,360,350],[720,400,420],[848,480,500],[1024,576,650],[1280,720,1000],[1920,1080,2000]];
		var g_video_size_type = 8; 
		var g_first_set_video_and_med = true;
		var g_video_fps = 15
		var g_video_qp = 0;
		var g_bg_color = 0;
		var g_residual_timer = -1;
		
		var g_meetingId; // 创建的会议号
		var g_meetingPsw; // 会议密码
		var g_meeLoginTimes = 0; // 记录掉线的次数1
		var g_meeLoginTimes2 = 0; // 记录的掉线次数 2
		var g_video_filename_list; // 媒体库所有媒体文件
		var g_getAll_videfile_list; // 获取所有视频文件信息
		var g_nowTime_play_num = -1; // 当前播放哪一个文件
		var g_server_name;//服务器地址
		var g_single_video = false//是否单摄像头
		
		var g_init_room = false//是否初始化完房间
		
		var g_bg_color;//修改背景颜色
		var g_init = false; ///  是否初始化
		var cr_account; // 云屋授权账号
		var cr_psw;//云屋授权密码
		
		
		var g_location_dir = location.href //目录地址
		
		var g_logo_id = "6cb4d64a-5647-11e7-bbc9-989096d01cf2"
		var end = g_location_dir.lastIndexOf('/')
		var start = g_location_dir.indexOf('file:///')
		if(start > -1)
		{
			start = 8
		}else
		{
			start = 0;
		}
		g_location_dir = g_location_dir.slice(start,end)+"/home/";
		g_location_dir = decodeURIComponent(g_location_dir);

		window.onbeforeunload = function()  
		{ 
			if(g_logining){
				CRVideo_Logout();
			}
			if(g_init){
				CRVideo_Uninit();
			}
			if(g_residual_timer != -1){
				clearInterval(g_residual_timer);
				g_residual_timer = -1;
			}
			if(g_layout != null){
				$(".detail_box").css('display','none');
			}
		}
		document.onkeydown = function (e) {
		    var ev = window.event || e;
		    var code = ev.keyCode || ev.which;
		    if (code == 116) {
		        if(ev.preventDefault) {
		            ev.preventDefault();
		            location.replace(location.href)
		        } else {
		            ev.keyCode = 0;
		            ev.returnValue = false;
		            location.replace(location.href)
		        }
		    }
		}
		// 屏蔽右键
		window.document.oncontextmenu = function(){ return false; };
		//----------------------------
		//
		//登录处理
		//
		//------------------------------
		//登录
		$("body").keydown(function(e) {
	        if (event.keyCode == "13") {//keyCode=13是回车键
	            login();	
	        }
	    });
		function login()
		{
			//------------------------------
			//
			//初始化
			//
			//------------------------------
			var result = CRVideo_Init("CLOUDROOM",g_location_dir);
			g_init = true;
			if(result == CRVideo_WEB_OCX_NOTINSTALLED)
			{
				alertLayer("没有安装插件");
			}else if(result == CRVideo_OCX_VERSION_NOTUPPORTED)
			{
				alertLayer("插件版本过低");
			}else if(result == CRVideo_WEB_BROWER_NOTUPPORTED)
			{
				alertLayer("不支持的浏览器");
			}else if(result != 0)
			{
				alertLayer("CRVideo_init sdkErr:"+result);
			}
			
			
			$(".login_button button").attr({"disabled":"disabled"});
			$(".login_button button").css({"backgroundColor":"#ccc","border":"1px solid #ccc"});
			if(g_logining == false)
			{
				var g_server_name = $("#server_name").val()
				if(g_server_name && g_server_name != '')
				{

					$("#catSerRecBtn").attr('href',"http://"+g_server_name+"/login.html");
					//云屋授权账号
					cr_account = $("#login_cpyName").val() || "demo@cloudroom.com";
					cr_psw =   md5($("#login_psd").val()) || "e10adc3949ba59abbe56e057f20f883e";

					//昵称
					g_nickname = uuid(32,16);
					//自定义帐号 
					g_userID = uuid(32,16);
					
					CRVideo_SetServerAddr(g_server_name);
					CRVideo_Login(cr_account,cr_psw,g_nickname,g_userID,"");
					
					g_logining = true;
				}else
				{
					alertLayer("服务器地址不能为空");
					$(".login_button button").attr({"disabled":false});
					$(".login_button button").css({"backgroundColor":"#eb5405","border":"1px solid #eb5405"});
				}
			}

		}
		//登录成功
		CRVideo_LoginSuccess.callback = function(usrID,cookie)
		{
		
			
			$(".login_button button").attr({"disabled":"disabled"});
			$(".login_button button").css({"backgroundColor":"#ccc","border":"1px solid #ccc"});
			g_usrID = usrID;
			createMeet();
		}
		//登录失败
		CRVideo_LoginFail.callback = function(sdkErr,cookie)
		{
			$(".login_button button").attr({"disabled":false});
			$(".login_button button").css({"backgroundColor":"#eb5405","border":"1px solid #eb5405"});
			g_logining = false;
			alertLayer("登录失败 错误码:"+sdkErr);
		}

		//------------------------------
		//
		//创建会议
		//
		//-----------------------------
		
		function createMeet()
		{
			
			CRVideo_CreateMeeting("财富宝货币市场基金 00034");
		}
		
		//创建会议成功
		CRVideo_CreateMeetingSuccess.callback = function(meetObj,cookie)
		{
			g_meetingId = meetObj.ID; // 将会议信息放入全局变量中
			g_meetingPsw = meetObj.pswd;
			enterMeet();
		}
		//创建会议失败
		CRVideo_CreateMeetingFail.callback = function(sdkErr,cookie)
		{
			alertLayer("创建会议失败 错误码:"+sdkErr);
			g_logining = false;
		}
		// 监听用户会议掉线状态 重登
		CRVideo_MeetingDropped.callback = function()
		{
			g_meeLoginTimes = g_meeLoginTimes + 1;// 每掉线一次，就将其加1 计数
			$("#full_page_msg_normal").css("display","none");
			$(".player_page_cancle").text("");
			$(".player_page_submit").text("");
			if(g_meeLoginTimes <= 1){
				enterMeetLayer(10,g_meetingId,g_meetingPsw);
			}else if(g_meeLoginTimes >= 2){
				enterMeetLayer(30,g_meetingId,g_meetingPsw);
			}else{
				enterMeetLayer(30,g_meetingId,g_meetingPsw)
			}
		}
		// 弹出重登界面的方法
		function enterMeetLayer(time,m_meetID,m_meetPsw){
			
			$("#login_time").text(time);
			// 提示用户已经离线
			$("#full_page_msg_normal").css("display","none");
			$(".player_page_cancle").text("");
			$(".player_page_submit").text("");
			$(".player_name_label").text("提示面板");
			$("#full_page_msg_time").css("display","block");
			$(".player_page_cancle").text("取消重登");
			$(".player_page_submit").text("立即重登");
			$(".player_page_cancle").css("display","inline-block");
			$(".player_page_submit").css("display","inline-block");
			$(".full_page").css("display","block");
			$(".warning_palyer").css("display","block");
			$(".detail_right_video").css('display','none');
			// 倒计时
			var timeNum = parseInt(time);
			var timer = setInterval(function(){
				timeNum--;
				if(timeNum <= 0){
					$("#login_time").text("0");
					enterMeet();
					$(".warning_palyer").css("display","none");
					$(".full_page").css("display","none");
					$("#full_page_msg_time").css("display","block");
					$(".player_page_cancle").text("");
					$(".player_page_submit").text("");
					$(".player_page_cancle").css("display","none");
					$(".player_page_submit").css("display","none");
					clearInterval(timer);
				}else{
					$("#login_time").text(timeNum);
				};
			},1000);
			$(".player_page_submit").click(function(){
				enterMeet();
				$(".warning_palyer").css("display","none");
				$(".full_page").css("display","none");
				$("#full_page_msg_time").css("display","none");
				$(".player_page_cancle").text("");
				$(".player_page_submit").text("");
				$(".player_page_cancle").css("display","none");
				$(".player_page_submit").css("display","none");
				if($(".list_container").css("display") == "block" || $(".full_page_div2").css("display") == "block" || $(".alert_palyer").css("display") == "block" || $(".full_page_div").css("display") == "block"){
			
				}else{
					$(".detail_right_video").css('display','block');
					updateVideo();
				}
				clearInterval(timer);
			});

		}
		// 会议离线
		CRVideo_LineOff.callback = function(sdkErr)
		{
			alertLayer("会议离线");
			if(g_residual_timer != -1){
				clearInterval(g_residual_timer);
				g_residual_timer = -1;
			}

		};
		//------------------------------
		//
		//进入会议
		//
		//-----------------------------
		function enterMeet()
		{
			CRVideo_EnterMeeting(g_meetingId,g_meetingPsw,g_userID,g_nickname);
		}
		//进入会议
		CRVideo_EnterMeetingRslt.callback = function(sdkErr)
		{
			if(sdkErr == CRVideo_NOERR)
			{
				CRVideo_SetPicResource(g_logo_id,{
				"fmt":"picdat",
				"dat":"iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAWfSURBVHjapJd7bFRFFIfPbLetFYMKvkANBhFbHjaiKKQK4R1SRcHWRFADRgIqJKBYY9SoJCZK1IBgoGKMj2ii8lDRJkIAKYjiA5oYRIj4hwQoBHwCfex2r9+ce9zebrelLLP57Zl77pyZc+Y8Zq5rWVYm6RYPANSBGP2Y5NO7kedboSWgB0iBw6BOAvkK7FNO4MI3LXJGLd4B3y98LxPOhw7uRL4ZbAQvglrJocWy8Ppj1WZpcW+BwUA6QQGYKCm3BZnlyHY7WwWGYXUtKNPtPDPMRokv6F2YqwuK8d8acGkHY/0y/5pM1NJ/CBpcEHj+8+BD4qEcmuiaAmHQ5BFoKxDs1W6Ek/38L8a6bdBTFqI9+L8LOg/+blPC7+ZOMA48Df/ZrrkgyXxJmY6+I6GSgWr4Q8Fx+ovARlAD5kjCrYZ/Lf0CcDMYBIaY3GOgJMt87RBnknxx7pEsyi3Hiqeg67DW5+rfmnqhCyaDqezYy9CJvN+mwdvauiE7E/ro6V2QQHsn12fwf2XyheKCT+j7xV/neQ1+LtXtdu5x+n6BBSzEs8yg/3XGHLcj4w1o6FyBpCvLwl/KxGNZaAT9JSwwD1zJhCPgvwrvED6/G1oIFoKPwZdgQmSOfowdAP2x8xhodsVA2iAhW/HxVPoJsFjLTVIOwH+O53WgN1jBmDdNZgyoaT+P6wskjaRVygi8C3pkKIWv3QnoQNP+BgliCYQPkiu+RJ9n4waB7uB3HetkPRZntp6RbFIl3CmSpZGHIB0DLpUhlGdoNj2vZvBDmopJ/OrcqIza4IOykTF5ukj72hG2BhY/4cLqkHDpN3GWOZQh5C28BHwD7rE6v0CzoW3bYcWmt40dnKWG1KuljeYSZ7U3Fo2BhKtr57tmNxn+SigKugr6s6CHI76tA3PpV4Ej4FuVaX3fANZKk9shJ2OhxbGOsqDZbdUtFDknwp+J5tVovIh+Ff0i5TmNl2aefU14iedRWvkCGU//OpN9R0tyoLWgEv4V4A/bse2ZJTpOnP/CQH+klrcpJCLvk3akYuCFXwA+7Q6Yz33JPgpGI9vAAktN7mHwqRYxkUkZ7vDtJzDfjvCQnaoY7SPSW7Kp3f4EKCfygF5AnOa493OTWhLo+T8J/mvQc7UeBPIBz7UWQ+EM4e4WmuePapYFnBUp+ShUYNKY/4d6K+Z0cApu0iAMNOUo3ZqilWCAjdljbqiJBON6lQvUtU28Gw79y07U++EPBXtdqjytQBFJ9xm9sTlcbOZa2lbb83tgL5hm1zdv/Q9Wlp80N77hjY7phjapeANleUp4ykWqV9ewHUyxvs+WndBK5psG3QJ+A6XwW6C7bdx43k+IS2Ob/EhowDk9WDjPg/MlS3XJCJRjBOtJhhUbw98JbsK61dBdBDHx4bbxvIIx/ay6+kPtcmQHxjPuLffp1gjnuXifYZU/doVzP6yO0ea383vG+Ng5CAoiMePd0TfMBtc/cvtqkXQR9pa5WFy3o3XAbOu/AqYbRYmgkBLcy2p/wO8YpJ4JiizdvFX7LD19PVgG7gTH7dkf6xdosIY3JrHY2BPdAX8nGBKx0Efz22HUOn8R+Rn8aQHFQq7UsiAebrWsRbGR9Pvo+SF8M+guas57RevN+mE2/2ZkNrhUSfoIfxCslNza52BG6BK5ynirwHdW1Br0fhDuqlf4JLrcggJ1cT2jw3aZ5N5uw7bhTDjNlPFX8wpwR3hh1QOu0MYmNW2d7qreiKIZcDatCvhPuCcsmMvsC6tnZMwuLfFCxWy9kqVfrrJozkWRfK3zgV5Ql9B/l74/vi+2wGXL5Qjv/DfHM7yrN0XafJjsN+TW9ANVLy4+4GbZ1u+z8uvj4BpwkY0uz6ZA7s27sUUzu0+E212/rLO33qf7Oj4zy5Pps2+DfT01diJRaNVS238CDAAJMxEnQFPLmQAAAABJRU5ErkJggg=="
							
				});
				CRVideo_OpenVideo(g_usrID);  // 打开本地摄像头
				CRVideo_SetEnableMutiVideo(g_usrID,true);  // 是否可以打开更多的摄像头
				CRVideo_OpenMic(g_usrID);   // 打开麦克风
				if(g_init_room == false){
					g_init_room = true
					$(".login_box").css("display","none")
					$(".menu_box").css('display','block');
				}else{

				}
				// 更新video 配置
				updateVideoCfg(g_video_size_type,g_video_fps,g_video_qp);
			}else
			{
				// 进入会议失败时弹出错误码
				alertLayer("进入会议失败 错误码:"+sdkErr);
				g_meeLoginTimes2 = g_meeLoginTimes2 + 1;// 每掉线一次，就将其加1 计数
				$("#full_page_msg_normal").css("display","none");
				$(".player_page_cancle").text("");
				$(".player_page_submit").text("");
				if(g_meeLoginTimes2 <= 1){
					enterMeetLayer(30,g_meetingId,g_meetingPsw);
				}else if(g_meeLoginTimes2 >= 2){
					enterMeetLayer(30,g_meetingId,g_meetingPsw);
				}else{
					enterMeetLayer(30,g_meetingId,g_meetingPsw)
				}
			}
			g_logining = false;
			// 文件上传流量控制
			CRVideo_SetFileUploadRate(g_FURate);
			// 是否加密，是1为加密，0为不加密
			CRVideo_SetRecordFileEncrypt(1);
			
			// 获取所有视频的列表信息
			g_getAll_videfile_list = CRVideo_GetAllRecordFiles();
		}
		//------------------------------
		//
		//进入坊间
		//
		//-----------------------------
		function enterRoom()
		{
			// 列表的设置及方法 此处列表是本地影音文件
			g_video_filename_list = CRVideo_GetAllFilesInMediaPath();
			showVideoFileList(g_video_filename_list);
			
			

			$(".full_page").css('display','none');
			$(".full_page_div").css('display','none');
			$(".menu_box").css("display","none")
			$(".detail_box").css('display','block'); 

			// 设置播放的midia
			g_mediaObj =  CRVideo_CreatMediaObj();
			g_mediaObj.id("mediaObj");
			$("#mediaContainer").append(g_mediaObj.handler());
            g_mediaObj.keepAspectRatio(true);


			// 创建和设置其他播放文件
			g_videoAObj = CRVideo_CreatVideoObj();
			g_videoAObj.id("videoAObj");
			$("#videoAContainer").append(g_videoAObj.handler());
			
			
			g_videoBObj = CRVideo_CreatVideoObj();
			g_videoBObj.id("videoBObj");
			$("#videoBContainer").append(g_videoBObj.handler());
			// A布局，两个视频文件的布局
			layoutA();
			// 更新摄像头
			setTimeout(updateVideo,500);
			// 定时更改背景
			g_residual_timer = setInterval(function()
			{
				if(g_bg_color != "#10132b")
				{
					$(".detail_right_video").css('background-color','#10232b')
					g_bg_color = "#10132b"
				}else
				{
					$(".detail_right_video").css('background-color','#10232a')
					g_bg_color = "#10232a"
				}
			}
			,100)
			
		}
		

		//-------------------------------
		//
		// 视频和摄像头布局
		//
		//-------------------------------
		function layoutA()
		{
			
			// 布局A，单摄像头显示一个，A;双摄像头显示两个AB
			g_layout = 'layoutA';

			// 主媒体文件影藏
			$("#mediaContainer").css("display","none");
			// 如果是单摄像头
			if(g_single_video)
			{
				$("#mediaContainer").css({"display":"none"});
				$("#videoAContainer").css({"display":"block","left":"124px","top":"0px","height":"300px"});
				g_videoAObj.width(534);
				g_videoAObj.height(300);
				
				$("#videoBContainer").css("display","none")
			}else
			{	// 双摄像头
				$("#mediaContainer").css({"display":"none"});
				$("#videoAContainer").css({"display":"block","left":"0px","top":"40px","width":"375px","height":"210px"});
				g_videoAObj.width(375);
				g_videoAObj.height(210);

				
				$("#videoBContainer").css({"display":"block","left":"375px","top":"40px","width":"375px","height":"210px"});
				g_videoBObj.width(375);
				g_videoBObj.height(210);
			}
			


			if(g_startRecord)
			{
				// 如果是在回放状态
				var recContents = [];
				
				
				
				if(g_recordHeight*16/9 > g_recordWidth)
				{
					var sWidth = g_recordWidth;
					var sHeight = g_recordWidth/16*9
					var sX = 0
					var sY = (g_recordHeight - sHeight)/2
				}else
				{
					var sWidth = g_recordHeight*16/9;
					var sHeight = g_recordHeight;
					var sX = (g_recordWidth - sWidth)/2
					var sY = 0
				}
				
				
				var videoAContent = {};
				var videoAStampContent = {};
				var videoAlogoContent = {}
				var videoBContent = {};
				var videoBStampContent = {};
				var videoBlogoContent = {}
				if(g_single_video)
				{
					// 单摄像头
					videoAContent["type"] = 0;
					videoAContent["left"] = sX;
					videoAContent["top"] =  sY;
					videoAContent["width"] = sWidth;
					videoAContent["height"] = sHeight;
					videoAContent["param"] = {"camid":g_usrID+"."+g_videoAObj.getVideoID()};
					recContents.push(videoAContent);
				}else
				{
					// 双摄像头
					videoAContent["type"] = 0;
					videoAContent["left"] = sX;
					videoAContent["top"] = sHeight/4 + sY;
					videoAContent["width"] = sWidth/2;
					videoAContent["height"] = sHeight/2;
					videoAContent["param"] = {"camid":g_usrID+"."+g_videoAObj.getVideoID()};
					recContents.push(videoAContent);

					videoBContent["type"] = 0;
					videoBContent["left"] = sX+sWidth/2;
					videoBContent["top"] = sHeight/4+ sY;
					videoBContent["width"] = sWidth/2;
					videoBContent["height"] = sHeight/2;
					videoBContent["param"] = {"camid":g_usrID+"."+g_videoBObj.getVideoID()};
					recContents.push(videoBContent);
					
					videoBlogoContent["type"] = CRVideo_REC_VCONTENT_TYPE.RECVTP_PIC;
					videoBlogoContent["left"] = videoBContent["left"]+3;
					videoBlogoContent["top"] = videoBContent["top"]+3;
					videoBlogoContent["width"] = 32;
					videoBlogoContent["height"] = 32;
					videoBlogoContent["param"] = {"resourceid":g_logo_id};
					recContents.push(videoBlogoContent);
					
					videoBStampContent["type"] = CRVideo_REC_VCONTENT_TYPE.RECVTP_TIMESTAMP;
					videoBStampContent["left"] = videoBContent["left"]+35;
					videoBStampContent["top"] = videoBContent["top"]+3;
					videoBStampContent["width"] = 175;
					videoBStampContent["height"] = 32;
					recContents.push(videoBStampContent);
				}
				videoAlogoContent["type"] = CRVideo_REC_VCONTENT_TYPE.RECVTP_PIC;
				videoAlogoContent["left"] = videoAContent["left"]+3;
				videoAlogoContent["top"] = videoAContent["top"]+3;
				videoAlogoContent["width"] = 32;
				videoAlogoContent["height"] = 32;
				videoAlogoContent["param"] = {"resourceid":g_logo_id};
				recContents.push(videoAlogoContent);
				
				videoAStampContent["type"] = CRVideo_REC_VCONTENT_TYPE.RECVTP_TIMESTAMP;
				videoAStampContent["left"] = videoAContent["left"]+35;
				videoAStampContent["top"] = videoAContent["top"]+3;
				videoAStampContent["width"] = 175;
				videoAStampContent["height"] = 32;
				recContents.push(videoAStampContent);
				
				
				
				// 设置录制信息
				CRVideo_SetRecordVideos(recContents);
			}
		}
		function layoutB()
		{
			// B布局：单摄像头显示两个主+A，双摄像头显示三个主+A+B
			g_layout = 'layoutB'

			if(g_single_video)
			{
				$("#mediaContainer").css({"display":"block","left":"0px","top":"40px","width":"375px","height":"210px"});
				g_mediaObj.width(375);
				g_mediaObj.height(210);
				

				$("#videoAContainer").css({"display":"block","left":"375px","top":"40px","width":"375px","height":"210px"});
				g_videoAObj.width(375);
				g_videoAObj.height(210);
				
				$("#videoBContainer").css("display","none");
				updateVideo();
			}else
			{
				$("#mediaContainer").css({"display":"block","left":"0px","top":"0px","width":"500px","height":"280px"})			
				g_mediaObj.width(500);
				g_mediaObj.height(280);
			
				$("#videoAContainer").css({"display":"block","left":"500px","top":"0px","width":"250px","height":"140px"})
				g_videoAObj.width(250);
				g_videoAObj.height(140);

				$("#videoBContainer").css({"display":"block","left":"500px","top":"140px","width":"250px","height":"140px"})
				g_videoBObj.width(250);
				g_videoBObj.height(140);
				updateVideo();

			}
			
			if(g_startRecord)
			{
				// 回放中
				var recContents = [];
				
				if(g_recordHeight*16/9 > g_recordWidth)
				{
					var sWidth = g_recordWidth;
					var sHeight = g_recordWidth/16*9
					var sX = 0
					var sY = (g_recordHeight - sHeight)/2
				}else
				{
					var sWidth = g_recordHeight*16/9;
					var sHeight = g_recordHeight;
					var sX = (g_recordWidth - sWidth)/2
					var sY = 0
				}
				
				var mediaContent = {}
				var mediaStampContent = {};
				var mediaStamplogoContent = {}
				var videoAContent = {};
				var videoAStampContent = {};
				var videoAlogoContent = {}
				var videoBContent = {};
				var videoBStampContent = {};
				var videoBlogoContent = {}
				
				if(g_single_video)
				{
					mediaContent["type"] = 3;
					mediaContent["left"] = sX;
					mediaContent["top"] = sHeight/4 + sY;
					mediaContent["width"] = sWidth/2;
					mediaContent["height"] = sHeight/2;
					mediaContent["param"] = "";
					recContents.push(mediaContent);

					videoAContent["type"] = 0;
					videoAContent["left"] = sX+sWidth/2;
					videoAContent["top"] = sHeight/4+ sY;
					videoAContent["width"] = sWidth/2;
					videoAContent["height"] = sHeight/2;
					videoAContent["param"] = {"camid":g_usrID+"."+g_videoAObj.getVideoID()};
					recContents.push(videoAContent);
				}else
				{
					mediaContent["type"] = 3;
					mediaContent["left"] = sX ;
					mediaContent["top"] = (sHeight/6)+ sY;
					mediaContent["width"] = sWidth*2/3
					mediaContent["height"] =  sHeight*2/3;
					mediaContent["param"] = "";
					recContents.push(mediaContent);
					
					
					videoAContent["type"] = 0;
					videoAContent["left"] = sWidth*2/3 + sX;
					videoAContent["top"] = sHeight/6 + sY;
					videoAContent["width"] = sWidth/3;
					videoAContent["height"] = sHeight/3;
					videoAContent["param"] = {"camid":g_usrID+"."+g_videoAObj.getVideoID()};
					recContents.push(videoAContent);
					
					
					videoBContent["type"] = 0;
					videoBContent["left"] = sWidth*2/3 + sX;
					videoBContent["top"] = sHeight/2 + sY;
					videoBContent["width"] = sWidth/3;
					videoBContent["height"] = sHeight/3;
					videoBContent["param"] = {"camid":g_usrID+"."+g_videoBObj.getVideoID()};
					recContents.push(videoBContent);
					
					videoBlogoContent["type"] = CRVideo_REC_VCONTENT_TYPE.RECVTP_PIC;
					videoBlogoContent["left"] = videoBContent["left"]+3;
					videoBlogoContent["top"] = videoBContent["top"]+3;
					videoBlogoContent["width"] = 32;
					videoBlogoContent["height"] = 32;
					videoBlogoContent["param"] = {"resourceid":g_logo_id};
					recContents.push(videoBlogoContent);
					
					videoBStampContent["type"] = CRVideo_REC_VCONTENT_TYPE.RECVTP_TIMESTAMP;
					videoBStampContent["left"] = videoBContent["left"]+35;
					videoBStampContent["top"] = videoBContent["top"]+3;
					videoBStampContent["width"] = 175;
					videoBStampContent["height"] = 32;
					recContents.push(videoBStampContent);

				}
				
				mediaStamplogoContent["type"] = CRVideo_REC_VCONTENT_TYPE.RECVTP_PIC;
				mediaStamplogoContent["left"] = mediaContent["left"]+3;
				mediaStamplogoContent["top"] = mediaContent["top"]+3;
				mediaStamplogoContent["width"] = 32;
				mediaStamplogoContent["height"] = 32;
				mediaStamplogoContent["param"] = {"resourceid":g_logo_id};
				recContents.push(mediaStamplogoContent);
				
				mediaStampContent["type"] = CRVideo_REC_VCONTENT_TYPE.RECVTP_TIMESTAMP;
				mediaStampContent["left"] = mediaContent["left"]+35;
				mediaStampContent["top"] = mediaContent["top"]+3;
				mediaStampContent["width"] = 175;
				mediaStampContent["height"] = 32;
				recContents.push(mediaStampContent);
				
				
				videoAlogoContent["type"] = CRVideo_REC_VCONTENT_TYPE.RECVTP_PIC;
				videoAlogoContent["left"] = videoAContent["left"]+3;
				videoAlogoContent["top"] = videoAContent["top"]+3;
				videoAlogoContent["width"] = 32;
				videoAlogoContent["height"] = 32;
				videoAlogoContent["param"] = {"resourceid":g_logo_id};
				recContents.push(videoAlogoContent);
				
				videoAStampContent["type"] = CRVideo_REC_VCONTENT_TYPE.RECVTP_TIMESTAMP;
				videoAStampContent["left"] = videoAContent["left"]+35;
				videoAStampContent["top"] = videoAContent["top"]+3;
				videoAStampContent["width"] = 175;
				videoAStampContent["height"] = 32;
				recContents.push(videoAStampContent);

				// 调用设置摄像头的方法
				CRVideo_SetRecordVideos(recContents);
			}
		}
		
		function layoutC()
		{
			// C布局，无论单双摄像头都只显示最大的 主 视频
			g_layout = 'layoutC'
			
			$("#mediaContainer").css({"display":"block","top":"0px","left":"124px","height":"300px"})
			g_mediaObj.width(534);
			g_mediaObj.height(300);
			$("#videoAContainer").css("display","none")
			$("#videoBContainer").css("display","none")

		}
		//-------------------------------
		//
		//语音能量处理
		//
		//-------------------------------
		//监听语音能量变化
		/* CRVideo_MicEnergyUpdate.callback = function(userID,oldLevel,newLevel)
		 {
		 	if(userID == g_usrID)
		 	{
                if($("#iframe1").length < 1){
                    var str = '<iframe src="src.html" frameborder="0"  noResize width="50" height="50" scrolling="no"  vspale="0" id="iframe1" name="iframe1" style="position:absolute;left:0;bottom:0;" allowtransparency="true"></iframe>'
                        //'<div style="width:50px;height:50px;position:absolute;left:0;bottom:0;z-index:1;"></iframe></div>'
                    //var str = '<div style="width:50px;height:50px;position:absolute;left:0;bottom:0;z-index:999;"><img id="iframe1" src="image/voice_1.png"/></div>'
                    $("#videoAContainer").append(str);
                    //changeMicEnergy("iframe1",newLevel);
                }
		 		
		 	}
		 }
		 function changeMicEnergy(iframeName,num){
		 	if(num == 0 || num == 1){
		 		$("#" + iframeName).attr("src","image/voice_1.png");
		 	}else if(num == 2 || num == 3){
		 		$("#" + iframeName).attr("src","image/voice_2.png");
		 	}else if(num == 4 || num == 5 || num == 6){
		 		$("#" + iframeName).attr("src","image/voice_3.png");
		 	}else if(num == 7 || num == 8){
		 		$("#" + iframeName).attr("src","image/voice_4.png");
		 	}else if(num == 10 ){
		 		$("#" + iframeName).attr("src","image/voice_5.png");
		 	}
		 }*/
		//-------------------------------
		//
		//摄像头处理
		//
		//-------------------------------
		//更新摄像头
		function updateVideo()
		{
			var devices = CRVideo_GetAllVideoInfo(g_usrID);  // 获取用户所有摄像头信息
			var devices_length = devices.length;
			try
			{
				if(g_videoAObj && devices_length >0)
				{
					g_videoAObj.setVideo(g_usrID,devices[0]['videoID']);
					g_videoAObj.setVisibleNickName(false);
				}
				if(g_videoBObj && devices_length >1)
				{
					//  设置Bvideo的昵称与设备
					g_videoBObj.setVideo(g_usrID,devices[1]['videoID']);
					g_videoBObj.setVisibleNickName(false);
				}
			}catch (e) 
			{
			}

		}
		//摄像头状态改变
		CRVideo_VideoStatusChanged.callback = function(userID,oldStatus,newStatus)
		{
			if(userID == g_usrID)
			{
				if(newStatus != CRVideo_VSTATUS.VOPEN || newStatus != CRVideo_VSTATUS.VOPENING)
				{
					
					CRVideo_OpenVideo(g_usrID)
				}
			}
		}
		//摄像头列表更新
		CRVideo_VideoDevChanged.callback = function(userID)
		{
			if(userID == g_usrID)
			{
				updateVideo();
			}
			
		}
		//设置摄像头
		function openSetVideoPanel()
		{
			//$(".detail_right_video").css('display','none');
			videoContainerHide()
			$(".full_page").css('display','block');
			$(".full_page_div2").css('display','block');
			setVideoAndMedia();
			// 打开设置按钮时，更新对应的信息
		}
		//------------------------------
		//
		//播放、停止媒体
		//
		//-----------------------------
		//播放媒体
		function video_play(videoName,num)
		{
			if(g_nowTime_play_num != -1)
			{
				// 如果现在没有播放，则开始播放点击的影音
				$("#videoList"+g_nowTime_play_num+" "+".voice1_item_play").css("display","block")
				$("#videoList"+g_nowTime_play_num+" "+".voice1_item_stop").css('display','none'); 
				$("#videoList"+g_nowTime_play_num+" "+".voice1_item_pause").css('display','none')
			}
			// 正在播放影音全局变量变为当前播放的影音编号
			g_nowTime_play_num = num;

			if(g_layout != 'layoutA')
			{
				// 如果不是A布局则停止播放
				CRVideo_StopPlayMedia();
			}
			g_playbacking = false;
			$('#playbackBtn').text("回放")
			$("#videoList"+num+" "+".voice1_item_play").css("display","none")
			$("#videoList"+num+" "+".voice1_item_stop").css('display','block'); 
			$("#videoList"+num+" "+".voice1_item_pause").css('display','none')
			
			// 调用布局B
			$(".detail_right_video").css('display','none');
			layoutB();
			if(g_uploading == false)
			{
				
				$(".detail_right_video").css('display','block');
				updateVideo();
			}
			// 开始播放
			CRVideo_StartPlayMedia(videoName);	
			

			
			
			
		}
		//停止播放媒体
		function video_stop(num)
		{
			// 调用A布局
			layoutA();
			$("#videoList"+num+" "+".voice1_item_play").css("display","block")
			$("#videoList"+num+" "+".voice1_item_stop").css('display','none'); 
			$("#videoList"+num+" "+".voice1_item_pause").css('display','none')
			g_nowTime_play_num = -1;
			CRVideo_StopPlayMedia();
			// 没有影音播放，停止媒体播放
		}
		//恢复播放媒体
		function video_pause_false(num)
		{
			$("#videoList"+num+" "+".voice1_item_play").css("display","none")
			$("#videoList"+num+" "+".voice1_item_stop").css('display','block'); 
			$("#videoList"+num+" "+".voice1_item_pause").css('display','none')
			
			CRVideo_PausePlayMedia(false);
			// 恢复影音播放，true为暂停播放 false为开始部播放
		}
		//暂停播放媒体
		function video_pause_true(num)
		{
			$("#videoList"+num+" "+".voice1_item_play").css("display","none")
			$("#videoList"+num+" "+".voice1_item_stop").css('display','none'); 
			$("#videoList"+num+" "+".voice1_item_pause").css('display','block'); 
			
			CRVideo_PausePlayMedia(true);
		}
		//媒体停止播放通知
		CRVideo_NotifyMediaStop.callback = function(userid)
		{
			// 当停止影音播放时就调用A布局
			$("#list_container").hide();
			$("#full_page_div2").hide();
			$("#full_page_div").hide();
			$("#warning_palyer").hide();
			$("#alert_palyer").hide();
			$("#full_page").hide();
			if(userid == g_usrID)
			{
				g_playbacking = false;
				$('#playbackBtn').text("回放")
				
				layoutA();
				$("#videoList"+g_nowTime_play_num+" "+".voice1_item_play").css("display","block")
				$("#videoList"+g_nowTime_play_num+" "+".voice1_item_stop").css('display','none'); 
				$("#videoList"+g_nowTime_play_num+" "+".voice1_item_pause").css('display','none')
				
				updateVideo();
			}
		}
		// SDK通知打开影音文件
		CRVideo_NotifyMediaOpened.callback = function(totalTime,width,height)
		{
			// C布局且比例为4:3
			if(g_layout == 'layoutC' && width/height == 4/3)
			{
				$("#mediaContainer").css({"display":"block","top":"1px","left":"176px","height":"297px"})
				g_mediaObj.width(396);
				g_mediaObj.height(297);
			}
			

		}
		//------------------------------
		//
		//录制
		//
		//-----------------------------
		//开始录像
		function startRecord()
		{
			if(g_playbacking)
			{
				alertLayer("回放时不能录制");
				return;
			}
			var date = new Date();
			var year = date.getFullYear();
			var month = date.getMonth()+1;
			var day = date.getDate();
			var hour = date.getHours();
			var minute = date.getMinutes();
			var second = date.getSeconds();
			g_record = year + "-" + month + "-" + day + "-" + hour+'-' + minute + '-' + second+".mp4"
			CRVideo_StartRecordIng(g_location_dir+g_record,CRVideo_RECORD_AUDIO_TYPE.REC_AUDIO_TYPE_ALL,g_frameRate,g_recordWidth,g_recordHeight,g_bitRate,22,g_recDataType,g_isUploadOnRecording);
			
			
			
			g_startRecord = true;
			$("#startRecordCon").css("display","none");
			$("#stopRecordCon").css("display","block");
			if(g_layout == 'layoutA')
			{
				layoutA();
			}else if(g_layout == 'layoutB')
			{
				layoutB();
			}else if(g_layout == 'layoutC')
			{
				layoutC();
			}
		}
		//停止录像
		function stopRecord()
		{
			CRVideo_StopRecord();
			$("#startRecordCon").css("display","block");
			$("#stopRecordCon").css("display","none");
			g_startRecord = false;
		}
		//回放录像
		function playbackRecord(fileName)
		{
			if(g_playbacking)
			{
				CRVideo_StopPlayMedia(); // 如果正在回放时点击回放则停止播放
			}else
			{
				if(fileName == null)
				{ // 如果回放文件名为空则return
					alertLayer("还没录制");
					return
				}
				if(g_layout != 'layoutA')
				{
					// 如果布局为A则停止播放影音
					video_stop(g_nowTime_play_num);
				}
				g_playbacking = true;
				// 布局改为C布局
				layoutC();
				$('#playbackBtn').text("停止回放")
				// 回放视频
                g_mediaObj.keepAspectRatio(true);	
                //alert(fileName)
				CRVideo_PlaybackRecordFile(fileName)

				
		

			}
		}
		//------------------------------
		//
		//上传
		//
		//-----------------------------
		function upload(fileName)
		{
			
			$("#percent_item").css("width","0");
			$("#upload_num_percert").text("0%");
			if(fileName == null)
			{
				alertLayer("还没录制");
				return
			}
			g_uploading = true;
			if($(".list_container").css("display") == "block"){
				
			}
			//$(".detail_right_video").css('display','none');
			videoContainerHide();
			$(".full_page").css('display','block');
			$(".full_page_div").css('display','block');
			CRVideo_UploadRecordFile(fileName)
		}

		function cancle_upload(fileName)
		{
			var fileNameDetail = fileName;
			$(".full_page_div").css('display','none');
			if($(".list_container").css("display") == "block"){
				// 重新展示视频列表
				g_getAll_videfile_list = CRVideo_GetAllRecordFiles();
				getAllVideoList(g_getAll_videfile_list)
			}else{
				//$(".detail_right_video").css('display','block');
				videoContainerShow();
				updateVideo();
			}
			if(g_uploading)
			{
				// 如果正在上传视频，则调用取消视频上传的方法
				CRVideo_CancelUploadRecordFile(fileName)
				g_uploading = false;
			}
			if($(".list_container").css("display") == "none"){
				$(".full_page").css('display','none');
			}else{
				$(".full_page").css('display','block');
			}
		}
		// sdk通知录制状态更改
		CRVideo_NotifyRecordFileStateChanged.callback = function(filename,state)
		{
			// console.log(filename)日期
			// console.log(state)1/2
			$("#file_name").text(filename);
			if(state == 2)
			{
				$('#upload_status').text("上传完成");
				$("#percent_item").css("width","100%");
				$("#upload_num_percert").text("100%");
				$('.full_page_cancle').text("确定");
				$(".full_page_submit").css("display","inline-block");
				
				g_uploading = false;
			}else if(state == 1)
			{
				$(".full_page_submit").css("display","none");
				$('#upload_status').text("上传中...")
				$('.full_page_cancle').text("取消上传")
			}else if(state == 0 && g_uploading)
			{
				$(".full_page_submit").css("display","none");
				$('#upload_status').text("准备上传...")
				$('.full_page_cancle').text("取消上传")
				$("#percent_item").css("width","0")
			}
			//console.log("CRVideo_NotifyRecordFileStateChanged(filename:"+filename+" state:"+state+")");
		}
		// 通知录制文件上传进度
		CRVideo_NotifyRecordFileUploadProgress.callback = function(filename,percent)
		{
			console.log(filename)//2018-1-4-17-4-17.mp4
			console.log(percent)//100
			//console.log("CRVideo_NotifyRecordFileUploadProgress(filename:"+filename+" percent:"+percent+")");
			$(".full_page_submit").css("display","none");
			$("#percent_item").css("width",percent+"%");
			$("#upload_num_percert").text(percent + "%");
		}
		// 上传文件失败通知
		CRVideo_UploadRecordFileErr.callback = function(fileName,err)
		{
			$('#upload_status').text("上传失败")
			$('.full_page_cancle').text("确定")
			
				g_uploading = false;
		}
		//更新video配置
		function updateVideoCfg(sizeType,fps,qp)
		{

			var cfg = {}

			
			cfg.sizeType = sizeType
			
			var fps = parseInt($("#frame_input").val())
			if(fps < 5)
			{
				fps = 5
			}else if(fps > 20)
			{
				fps = 20
			}
			cfg.fps = fps
			cfg.maxbps = video_size_arr[sizeType][2]*1000
			
			//var qp = $("#meet_yx").val()
			//var qp = $("input[name='meet_yx']:checked").val();
			if(qp == 1)
			{
				cfg.qp_min = 22
				cfg.qp_max = 36
			}else if(qp == 0)
			{
				cfg.qp_min = 22
				cfg.qp_max = 25
			}
			//系统视频参数设置
			CRVideo_SetVideoCfg(cfg);
			//配置远程影音共享时，图像质量参数
			CRVideo_SetMediacfg(cfg)
		}
		//------------------------------
		//
		//设置
		//
		//-----------------------------
		function setSubmit()
		{
			$(".full_page").css('display','none');
			$(".full_page_div2").css('display','none');
			if($(".list_container").css("display") == "block"){
			}else{
				//$(".detail_right_video").css('display','block');
				videoContainerShow()
				updateVideo();
			}
			g_FURate = $("#fuRate").val()*1024;
			g_bitRate = $("#bitRate").val() * 1000;
			g_frameRate = $("#frameRate").val();
			g_recDataType = $("input[name='recDataType'][checked]").val();
			//g_recDataType = $("input[name='recDataType']:checked").val();
			g_isUploadOnRecording = $("input[name='recUpType'][checked]").val();
			var recordWH = $("#recordWH").val();
			if(recordWH == 1)
			{
				g_recordWidth = 640;
				g_recordHeight = 360;
			}else if(recordWH == 2)
			{
				g_recordWidth = 848;
				g_recordHeight = 480;
			}else if(recordWH == 3)
			{
				g_recordWidth = 1280;
				g_recordHeight = 720;
			}else if(recordWH == 4)
			{
				g_recordWidth = 1920;
				g_recordHeight = 1080;
			}else if(recordWH == 5)
			{
				g_recordWidth = 640;
				g_recordHeight = 480;
			}
			//文件上传的流量控制(SDK默认不开启流控,目前对文件上传控制的功能有：录制文件上传、网盘文件上传。)
			CRVideo_SetFileUploadRate(g_FURate);
			g_video_size_type = $("#size_select").val();
			g_video_fps =  $("#frame_input").val();
			g_video_qp = $("input[name='meet_yx']:checked").val();
			//跟新视频
			updateVideoCfg(parseInt(g_video_size_type),parseInt(g_video_fps),parseInt(g_video_qp));
		}
		function setCancle()
		{
			$(".full_page").css('display','none');
			$(".full_page_div2").css('display','none');
			if($(".list_container").css("display") == "block"){
			}else{
				//$(".detail_right_video").css('display','block');
				//容器显示视频
				videoContainerShow();
				//跟新视频
				updateVideo();
			}
			
			$("#fuRate").val(g_FURate/1024);
			$("#bitRate").val(g_bitRate/1000) ;
			$("#frameRate").val(g_frameRate);
			$("input[name='recDataType'][value="+ g_recDataType+"]").attr("checked",true);
			//$("#recDataType").val(g_recDataType);
			if(g_recordHeight == 360)
			{
				var recordWH = $("#recordWH").val(1);
			}else if(g_recordHeight == 480)
			{
				if(g_recordWidth == 640)
				{
					var recordWH = $("#recordWH").val(5);
				}else
				{
					var recordWH = $("#recordWH").val(2);
				}
				
			}else if(g_recordHeight == 720)
			{
				var recordWH = $("#recordWH").val(3);
			}else if(g_recordHeight == 1080)
			{
				var recordWH = $("#recordWH").val(4);
			}
		}
		// 正在播放的列表
		function showVideoFileList(list){
			if(list && list != "" && list != null){
				var listLength = list.length;
				var str = "";
				for(var i=0;i< listLength; i++){
					var listname = list[i].split("Media/")[1];
					str += "<li id='videoList"+ i +"'>"
						+	"<span class='detail_right_voice1_item_name'>" + listname +"</span>"
						+	"<span class='detail_right_voice1_item_img'>"
						+		"<div class='voice1_item_play'>"
						+			"<img src='image/icon_04.png' onclick='video_play(\""+list[i]+"\","+i+")'/>"
						+		"</div>"
						+		"<div class='voice1_item_stop' style='display:none'>"
						+			"<img src='image/icon_02.png' onclick='video_pause_true("+ i +")'/>"
						+			"<img src='image/icon_03.png' onclick='video_stop("+ i +")'/>"
						+		"</div>"
						+		"<div class='voice1_item_pause' style='display:none'>"
						+			"<img src='image/icon_04.png' onclick='video_pause_false("+ i +")'/>"
						+			"<img src='image/icon_03.png' onclick='video_stop("+ i +")'/>"
						+		"</div>"
						+	"</span>"
						+"</li>"
				}
				str += "<div style='height:0;clear:both;'></div>"
				$("#detail_video_lists").append(str);
			}
		}
		// 回放list table中的视频
		function playbackList(i){
			// 弹出层隐藏 并开始回放
			var fileName = $("#fileName"+ i).text();
			closelistPage();
			if(g_playbacking)
			{
				CRVideo_StopPlayMedia();
			}
			playbackRecord(fileName);

			//$(".detail_right_video").css('display','block');
			videoContainerShow();
			updateVideo();
		}
		// tableList 中的删除事件
		function deleteFile(i){
			if(g_playbacking)
			{
				alertLayer("回放状态不能删除");
				return;
			}
			var fileName = $("#fileName"+ i).text();
			CRVideo_RemoveFromFileMgr(fileName);
			if($("#list_item"+i).length > 0){
				$("#list_item"+i).remove();
			}
		}
		function uploadFile(i){
			var fileName = $("#fileName"+ i).text();
			upload(fileName);
		}
	
	</script>
</body>
</html>



